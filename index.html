<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TowerStory</title>
  <style>
    html, body { height:100%; width:100%; margin:0; padding:0; background: url('assets/images/background.png') center/cover no-repeat; }
    body { display:grid; grid-template-rows:80px auto 60px; grid-template-columns:200px auto 200px;
      grid-template-areas: "header header header" "sidebar-left main sidebar-right" "footer footer footer";
      align-items:center; justify-items:center; }
    #header { grid-area: header; }
    #sidebar-left { grid-area: sidebar-left; }
    #sidebar-right { grid-area: sidebar-right; }
    #footer { grid-area: footer; }
    #game-container {
      grid-area: main;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%; height: 100%; overflow: hidden;
    }
    #game-container canvas { max-width: 100%; max-height: 100%; }
  </style>
</head>
<body>
  <div id="header"></div>
  <div id="sidebar-left"></div>
  <div id="game-container"></div>
  <div id="sidebar-right"></div>
  <div id="footer"></div>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <script>
    window.addEventListener('load', () => {
      class BootScene extends Phaser.Scene { constructor(){ super('Boot'); } create(){ this.scene.start('Preload'); } }
      class PreloadScene extends Phaser.Scene {
        constructor(){ super('Preload'); }
        preload(){
          this.load.tilemapTiledJSON('room','assets/maps/room.json');
          this.load.spritesheet('tileset','assets/tiles/tileset.png',{ frameWidth:38, frameHeight:38 });
          this.load.spritesheet('player','assets/player/Chibi-character-template_skin0_part2_by_AxulArt.png',{ frameWidth:32, frameHeight:32 });
          this.load.image('chest','assets/objects/chest.png');
          this.load.image('npc','assets/objects/npc.png');
          this.load.image('potion','assets/icons/potion.png');
          this.load.image('sword','assets/icons/sword.png');
          this.load.image('coin','assets/icons/coin.png');
        }
        create(){ this.scene.start('Main'); }
      }
      class MainScene extends Phaser.Scene {
        constructor(){ super('Main'); }
        create(){ /* existing MainScene code */ }
        update(){ /* existing MainScene update */ }
        // ... other MainScene methods
      }
      class InventoryScene extends Phaser.Scene {
        constructor(){ super('InventoryScene'); }
        init(data){ /* existing init */ }
        create(){ /* existing create */ }
        // ... other InventoryScene methods
      }

      const config = {
        type: Phaser.AUTO,
        parent: 'game-container',
        scale: { mode: Phaser.Scale.FIT, autoCenter: Phaser.Scale.CENTER_BOTH },
        physics: { default: 'arcade' },
        scene: [BootScene, PreloadScene, MainScene, InventoryScene]
      };
      new Phaser.Game(config);
    });
  </script>
</body>
</html>
